<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>ECharts</title>
    <!-- 引入 echarts.js -->
    <link rel="stylesheet" th:href="@{/css/font.css}">
    <link rel="stylesheet" th:href="@{/css/xadmin.css}">
    <script th:src="@{/js/jquery.min.js}"></script>
    <script type="text/javascript" th:src="@{/lib/layui/layui.js}" charset="utf-8"></script>
    <script type="text/javascript" th:src="@{/js/xadmin.js}"></script>
    <script src="https://cdn.staticfile.org/echarts/4.3.0/echarts.min.js"></script>
    <!-- 让IE8/9支持媒体查询，从而兼容栅格 -->
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body>
<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
<div class="layui-row" style="margin-top: 20px;margin-left: 20px">
    <form class="layui-form layui-col-md12 x-so">
        <div>
            <label style="font-size: 16px">商品类型</label>
            <div class="layui-input-inline">
                <select id="producttype" name="producttype">
                    <option value="all">所有商品</option>
                    <option value="宠物寄养">宠物寄养</option>
                    <option value="宠物食品">宠物食品</option>
                    <option value="宠物饰品">宠物饰品</option>
                </select>
            </div>
            <input class="layui-input" placeholder="开始日" name="starttime" id="starttime" autocomplete="off">
            <input class="layui-input" placeholder="截止日" name="endtime" id="endtime" autocomplete="off">
            <button type="button" class="layui-btn layui-btn-primary" onclick="findsale()">查询</button>
            </button>
        </div>
    </form>
</div>
<div style="margin-left: 25%">
    <div>
        <label id="strat_time_tile" style="font-size: 18px;margin-left: 5%"></label>
        <label style="font-size: 18px">至</label>
        <label id="end_time_tile" style="font-size: 18px;"></label>
        <label id="product_type_title" style="font-size: 18px;"></label>
        <label style="font-size: 18px;">销售情况</label>
    </div>
    <div id="main" style="width: 600px;height:400px;"></div>
</div>
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例

    function findsale() {
        var producttype = $("#producttype").find("option:selected").val();
        var starttime = $('#starttime').val();
        var endtime = $('#endtime').val();
        var myChart = echarts.init(document.getElementById('main'));
        if (producttype == 'all') {
            myChart.setOption(bareconfigure());
        } else {
            myChart.setOption(lineconfigure());
        }
        $('#strat_time_tile').text(starttime);
        $('#end_time_tile').text(endtime);
        if (producttype == 'all') {
            $('#product_type_title').text('所有商品');
        } else {
            $('#product_type_title').text(producttype);
            $.ajax({
                url: "/salesrecord/SaleEcharts",
                async: false,
                type: 'post',
                data: {
                    product_type: producttype,
                    starttime: starttime,
                    endtime: endtime
                },
                success: function (result) {
                    $.each(result, function (index, item) {
                        console.log(item['create_time'].toString());
                    })
                }

            });
        }
    }


    layui.use('laydate', function () {
        var laydate = layui.laydate;

        //执行一个laydate实例
        laydate.render({
            elem: '#starttime' //指定元素
        });

        //执行一个laydate实例
        laydate.render({
            elem: '#endtime' //指定元素
        });
    });

    //条形图配置
    function bareconfigure(xaxisdatas, seriesdatas) {
        var baroption = {
            xAxis: {
                type: 'category',
                data: xaxisdatas
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                data: seriesdatas,
                type: 'bar',
                showBackground: true,
                backgroundStyle: {
                    color: 'rgba(220, 220, 220, 0.8)'
                }
            }]
        };
        return baroption
    }

    //折线图配置
    function lineconfigure(xaxisdatas, seriesdatas) {
        // 指定图表的配置项和数据
        var lineoption = {
            xAxis: {
                type: 'category',
                data: ['1', '2', '3', '4', '5', '6', '7']
            },
            yAxis: {
                type: 'value'
            },
            series: [{
                data: [820, 932, 901, 934, 1290, 1330, 1320],
                type: 'line'
            }]
        };
        return lineoption;
    }
</script>
</body>
</html>